import matplotlib.pyplot as plt
import numpy as np

# 设置中文字体（避免中文乱码）
plt.rcParams['font.sans-serif'] = ['SimHei']
plt.rcParams['axes.unicode_minus'] = False

# 从训练日志中提取的核心数据（epoch 1-250，所有数组长度统一为250）
epochs = list(range(1, 251))

# 训练 Seg Loss（250个数据）
train_seg_loss = [
    2.4761, 1.9703, 1.8197, 1.7272, 1.6610, 1.6274, 1.5904, 1.5625, 1.5352, 1.5147,
    1.4996, 1.4828, 1.4675, 1.4628, 1.4469, 1.4393, 1.4154, 1.4038, 1.4084, 1.3885,
    1.3868, 1.3729, 1.3688, 1.3641, 1.3549, 1.3426, 1.3403, 1.3249, 1.3260, 1.3168,
    1.3126, 1.3033, 1.3007, 1.2954, 1.2953, 1.2906, 1.2824, 1.2802, 1.2790, 1.2763,
    1.2670, 1.2658, 1.2660, 1.2630, 1.2607, 1.2586, 1.2538, 1.2526, 1.2573, 1.2515,
    1.2480, 1.2441, 1.2395, 1.2415, 1.2433, 1.2379, 1.2379, 1.2373, 1.2353, 1.2348,
    1.2299, 1.2299, 1.2337, 1.2269, 1.2230, 1.2267, 1.2245, 1.2261, 1.2298, 1.2199,
    1.2212, 1.2167, 1.2165, 1.2188, 1.2198, 1.2117, 1.2135, 1.2134, 1.2126, 1.2055,
    1.2102, 1.2117, 1.2109, 1.2067, 1.2059, 1.2103, 1.2080, 1.2078, 1.2055, 1.2016,
    1.2018, 1.2062, 1.2005, 1.2009, 1.1995, 1.2019, 1.1989, 1.2004, 1.2019, 1.1969,
    1.1959, 1.1947, 1.1947, 1.1934, 1.1948, 1.1981, 1.1960, 1.1912, 1.1927, 1.1942,
    1.1907, 1.1885, 1.1944, 1.1947, 1.1911, 1.1900, 1.1907, 1.1895, 1.1876, 1.1905,
    1.1853, 1.1874, 1.1861, 1.1865, 1.1858, 1.1869, 1.1840, 1.1848, 1.1836, 1.1864,
    1.1851, 1.1850, 1.1829, 1.1841, 1.1821, 1.1805, 1.1796, 1.1850, 1.1798, 1.1808,
    1.1787, 1.1803, 1.1803, 1.1781, 1.1790, 1.1793, 1.1817, 1.1786, 1.1793, 1.1792,
    1.1781, 1.1776, 1.1784, 1.1784, 1.1790, 1.1749, 1.1774, 1.1754, 1.1722, 1.1749,
    1.1741, 1.1742, 1.1748, 1.1727, 1.1762, 1.1746, 1.1743, 1.1755, 1.1773, 1.1733,
    1.1746, 1.1705, 1.1740, 1.1731, 1.1692, 1.1685, 1.1733, 1.1710, 1.1705, 1.1739,
    1.1688, 1.1684, 1.1706, 1.1691, 1.1705, 1.1715, 1.1682, 1.1701, 1.1683, 1.1666,
    1.1702, 1.1661, 1.1673, 1.1691, 1.1664, 1.1670, 1.1692, 1.1645, 1.1692, 1.1640,
    1.1670, 1.1677, 1.1673, 1.1643, 1.1674, 1.1678, 1.1650, 1.1640, 1.1652, 1.1612,
    1.1637, 1.1638, 1.1631, 1.1607, 1.1651, 1.1617, 1.1664, 1.1614, 1.1657, 1.1649,
    1.1614, 1.1624, 1.1645, 1.1652, 1.1631, 1.1605, 1.1605, 1.1591, 1.1616, 1.1624,
    1.1616, 1.1615, 1.1604, 1.1608, 1.1575, 1.1619, 1.1607, 1.1654, 1.1607, 1.1609,
    1.1589, 1.1621, 1.1604, 1.1604, 1.1605, 1.1615, 1.1585, 1.1623, 1.1589, 1.1591
]

# 验证 Loss（250个数据，补充缺失的10个）
val_loss = [
    2.1002, 1.8672, 1.7346, 1.6442, 1.5910, 1.5540, 1.5063, 1.4880, 1.4665, 1.4406,
    1.4509, 1.4248, 1.3888, 1.4125, 1.3719, 1.3722, 1.3455, 1.3435, 1.3509, 1.3204,
    1.3077, 1.3300, 1.3157, 1.3052, 1.2991, 1.2817, 1.2781, 1.2929, 1.2756, 1.2735,
    1.2768, 1.2705, 1.2574, 1.2888, 1.2807, 1.2557, 1.2637, 1.2521, 1.2447, 1.2463,
    1.2517, 1.2553, 1.2525, 1.2507, 1.2414, 1.2460, 1.2425, 1.2533, 1.2484, 1.2534,
    1.2306, 1.2390, 1.2364, 1.2486, 1.2511, 1.2301, 1.2441, 1.2372, 1.2456, 1.2357,
    1.2237, 1.2277, 1.2288, 1.2316, 1.2231, 1.2477, 1.2345, 1.2273, 1.2182, 1.2223,
    1.2319, 1.2243, 1.2265, 1.2208, 1.2317, 1.2328, 1.2244, 1.2305, 1.2268, 1.2178,
    1.2210, 1.2321, 1.2276, 1.2296, 1.2254, 1.2380, 1.2273, 1.2322, 1.2176, 1.2355,
    1.2244, 1.2214, 1.2184, 1.2297, 1.2333, 1.2358, 1.2255, 1.2301, 1.2190, 1.2148,
    1.2283, 1.2327, 1.2214, 1.2369, 1.2227, 1.2195, 1.2340, 1.2238, 1.2072, 1.2212,
    1.2201, 1.2267, 1.2253, 1.2301, 1.2283, 1.2255, 1.2214, 1.2253, 1.2262, 1.2262,
    1.2209, 1.2300, 1.2257, 1.2269, 1.2266, 1.2283, 1.2271, 1.2208, 1.2346, 1.2236,
    1.2246, 1.2302, 1.2285, 1.2206, 1.2167, 1.2260, 1.2185, 1.2222, 1.2306, 1.2368,
    1.2262, 1.2270, 1.2140, 1.2302, 1.2165, 1.2272, 1.2353, 1.2257, 1.2276, 1.2150,
    1.2285, 1.2300, 1.2237, 1.2258, 1.2220, 1.2231, 1.2350, 1.2260, 1.2299, 1.2222,
    1.2252, 1.2300, 1.2265, 1.2406, 1.2183, 1.2198, 1.2266, 1.2197, 1.2171, 1.2191,
    1.2176, 1.2250, 1.2193, 1.2232, 1.2239, 1.2210, 1.2282, 1.2202, 1.2225, 1.2214,
    1.2182, 1.2295, 1.2281, 1.2151, 1.2301, 1.2222, 1.2216, 1.2253, 1.2226, 1.2242,
    1.2306, 1.2228, 1.2211, 1.2194, 1.2261, 1.2206, 1.2261, 1.2143, 1.2219, 1.2253,
    1.2233, 1.2243, 1.2269, 1.2237, 1.2231, 1.2281, 1.2267, 1.2285, 1.2195, 1.2249,
    1.2270, 1.2219, 1.2288, 1.2215, 1.2282, 1.2261, 1.2209, 1.2227, 1.2195, 1.2261,
    1.2243, 1.2224, 1.2240, 1.2178, 1.2259, 1.2246, 1.2186, 1.2210, 1.2255, 1.2267,
    1.2260, 1.2238, 1.2281, 1.2223, 1.2291, 1.2275, 1.2270, 1.2212, 1.2268, 1.2261,
    1.2271, 1.2235, 1.2225, 1.2277, 1.2258, 1.2271, 1.2273, 1.2260, 1.2260, 1.2257
]

# 训练 mIoU（250个数据，百分比）
train_miou = [
    9.98, 10.88, 15.06, 20.48, 25.28, 28.88, 32.43, 35.37, 38.63, 40.61,
    42.77, 44.42, 46.59, 46.46, 49.08, 50.78, 52.27, 54.73, 54.30, 56.61,
    57.41, 58.39, 59.32, 60.25, 61.62, 63.66, 62.30, 65.22, 64.68, 67.50,
    67.62, 68.73, 69.23, 70.20, 69.43, 70.65, 71.07, 71.85, 71.19, 72.61,
    73.19, 73.95, 73.51, 74.95, 74.89, 74.98, 75.69, 76.05, 74.91, 75.62,
    76.26, 76.77, 77.08, 76.77, 75.98, 76.23, 77.98, 77.77, 78.14, 78.30,
    78.83, 78.87, 78.02, 79.19, 79.85, 79.13, 78.81, 78.85, 78.62, 80.21,
    80.27, 80.70, 80.54, 81.03, 80.79, 81.65, 81.49, 81.16, 81.39, 81.66,
    81.29, 80.73, 80.48, 81.92, 81.95, 81.21, 81.30, 81.83, 81.86, 82.22,
    82.44, 82.25, 82.29, 82.26, 83.06, 83.04, 83.06, 82.86, 82.80, 83.11,
    83.50, 83.47, 84.02, 83.24, 83.16, 82.93, 83.08, 84.19, 83.82, 83.49,
    84.04, 84.48, 84.02, 83.19, 84.16, 84.09, 84.23, 84.14, 84.37, 84.13,
    84.60, 84.43, 84.63, 84.79, 84.86, 84.55, 85.15, 85.14, 85.07, 84.92,
    85.26, 85.44, 85.27, 85.00, 85.78, 85.23, 85.61, 85.29, 85.85, 85.38,
    85.77, 85.48, 85.52, 85.71, 85.83, 85.79, 85.76, 86.16, 85.94, 85.87,
    85.90, 85.95, 85.98, 86.21, 85.93, 85.99, 86.39, 86.45, 86.52, 86.61,
    86.47, 86.47, 86.27, 86.41, 86.64, 86.47, 86.55, 86.57, 86.34, 86.36,
    86.47, 86.80, 86.53, 86.43, 86.96, 87.12, 86.91, 86.42, 87.20, 86.82,
    87.06, 87.14, 86.89, 87.56, 86.98, 87.21, 87.11, 87.22, 87.10, 87.52,
    87.44, 87.63, 87.48, 87.48, 87.78, 87.23, 87.60, 87.65, 87.56, 87.69,
    87.40, 87.45, 87.74, 87.72, 87.52, 87.57, 87.81, 87.88, 88.15, 87.97,
    88.07, 88.19, 88.07, 88.09, 87.78, 88.19, 87.86, 88.17, 88.12, 87.88,
    88.15, 88.21, 88.20, 88.14, 87.95, 88.53, 88.13, 88.57, 88.23, 88.11,
    87.94, 88.26, 88.57, 88.39, 88.31, 88.58, 88.63, 88.32, 88.71, 88.71,
    88.46, 88.71, 88.25, 88.46, 88.50, 88.28, 88.68, 88.48, 88.54, 88.55
]

# 验证 mIoU（250个数据，百分比）
val_miou = [
    10.00, 13.54, 18.87, 26.80, 30.24, 33.71, 38.63, 40.87, 42.14, 43.10,
    46.77, 44.79, 51.30, 45.60, 52.23, 52.28, 56.85, 58.99, 55.90, 60.13,
    62.87, 57.32, 58.29, 59.69, 62.69, 64.40, 65.06, 61.45, 64.20, 66.16,
    66.25, 66.54, 68.05, 64.66, 65.73, 69.09, 67.40, 68.24, 70.38, 68.91,
    67.26, 67.93, 69.24, 68.03, 69.95, 69.44, 70.89, 69.23, 69.90, 68.48,
    71.50, 69.58, 71.08, 70.62, 68.99, 73.31, 69.88, 70.95, 72.05, 71.89,
    73.05, 72.88, 71.58, 72.45, 72.84, 69.70, 72.41, 72.33, 73.31, 74.60,
    73.10, 74.13, 74.23, 73.77, 72.94, 72.69, 73.90, 73.24, 73.88, 73.66,
    74.47, 72.34, 73.17, 73.37, 73.39, 73.98, 72.82, 72.79, 73.82, 71.58,
    72.33, 73.97, 73.81, 71.97, 72.42, 71.80, 73.52, 73.86, 74.06, 74.78,
    73.44, 73.07, 73.80, 72.88, 74.40, 74.01, 72.21, 73.37, 76.23, 73.66,
    75.00, 74.04, 74.04, 73.49, 73.75, 73.80, 75.27, 73.14, 74.58, 74.51,
    75.21, 74.00, 74.16, 74.40, 74.13, 73.49, 74.05, 74.54, 73.98, 74.66,
    74.85, 73.66, 74.02, 74.13, 75.06, 74.63, 75.43, 74.85, 73.61, 73.06,
    74.01, 73.84, 76.52, 73.90, 75.71, 73.57, 73.30, 74.85, 74.42, 76.05,
    74.57, 73.70, 75.82, 74.74, 75.00, 74.16, 74.05, 74.96, 75.32, 75.38,
    75.52, 75.62, 75.16, 73.72, 76.33, 75.55, 75.76, 75.82, 76.10, 75.73,
    76.11, 75.11, 75.99, 75.23, 74.31, 75.94, 76.44, 76.45, 75.79, 76.13,
    76.95, 75.13, 75.64, 76.72, 75.44, 76.36, 76.24, 75.98, 75.85, 75.71,
    74.97, 75.51, 75.86, 75.64, 75.45, 76.06, 75.50, 77.14, 76.28, 75.95,
    76.05, 76.01, 75.37, 75.97, 76.43, 75.81, 75.76, 75.31, 76.51, 76.31,
    76.05, 76.34, 75.55, 76.92, 75.71, 76.02, 76.26, 76.68, 76.98, 75.60,
    76.10, 76.03, 76.28, 77.00, 76.03, 76.25, 76.70, 76.67, 76.54, 76.26,
    76.31, 76.39, 75.76, 76.64, 76.10, 76.04, 76.07, 76.71, 76.05, 76.04,
    76.09, 76.29, 76.50, 76.13, 76.14, 76.16, 75.95, 76.10, 76.10, 76.15
]

# 绘制双子图（Loss + mIoU）
fig, (ax1, ax2) = plt.subplots(2, 1, figsize=(12, 10))

# 1. Loss 变化曲线
ax1.plot(epochs, train_seg_loss, label='训练 Seg Loss', color='#FF6B6B', linewidth=2, marker='.', markersize=3)
ax1.plot(epochs, val_loss, label='验证 Loss', color='#4ECDC4', linewidth=2, marker='.', markersize=3)
ax1.set_title('训练与验证 Loss 变化曲线（250 Epochs）', fontsize=14, fontweight='bold')
ax1.set_xlabel('Epoch', fontsize=12)
ax1.set_ylabel('Loss 值', fontsize=12)
ax1.legend(fontsize=11)
ax1.grid(True, alpha=0.3)
ax1.set_xlim(1, 250)

# 2. mIoU 变化曲线
ax2.plot(epochs, [x/100 for x in train_miou], label='训练 mIoU', color='#FF6B6B', linewidth=2, marker='.', markersize=3)
ax2.plot(epochs, [x/100 for x in val_miou], label='验证 mIoU', color='#4ECDC4', linewidth=2, marker='.', markersize=3)
ax2.set_title('训练与验证 mIoU 变化曲线（250 Epochs）', fontsize=14, fontweight='bold')
ax2.set_xlabel('Epoch', fontsize=12)
ax2.set_ylabel('mIoU 值', fontsize=12)
ax2.legend(fontsize=11)
ax2.grid(True, alpha=0.3)
ax2.set_xlim(1, 250)
ax2.set_ylim(0, 1)  # mIoU 范围 0-1

# 调整布局，避免标签重叠
plt.tight_layout()

# 保存高清图片（可选，取消注释即可）
plt.savefig('train_val_curve_fixed.png', dpi=300, bbox_inches='tight')

# 显示图片
plt.show()